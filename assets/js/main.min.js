console.info('We use JSlibrary "lightGallery" under their opensource license.\nVisit here for source code.');const gallery=document.getElementById("gallery"),$window=$(window);{const a=document.getElementById("scrollToTop");200<$window.scrollTop()?(a.classList.remove("scrlBtnHidden"),a.classList.add("scrlBtnShow")):(a.classList.remove("scrlBtnShow"),a.classList.add("scrlBtnHidden")),a.addEventListener("click",()=>{window.scroll({top:0,behavior:"smooth"})})}const thumbsPerScroll=40,directory="./assets/images/gallery/";let lg,list,rawList,loaded=0,loading=!1;document.getElementById("fSpoiler").addEventListener("change",blockSpoiler),document.getElementById("loadBtn").addEventListener("click",loadMore);let filters=document.getElementsByClassName("filters");for(let e=0;e<filters.length;e++)filters[e].addEventListener("change",doSearch);async function init(){rawList||await getData(),list.length>thumbsPerScroll?await attatch(list,thumbsPerScroll):await attatch(list,list.length),await initializeGalleries(),blockSpoiler()}function refresh(){initJg(),blockSpoiler(),setTimeout(()=>{lg.refresh()},500)}init();let lg;display();async function display(){var n="./assets/images/gallery/",o=await fetch("assets/contents.json").then(e=>e.json());const i=document.getElementById("gallery");for(let l=0;l<o.length;l++){let e=document.createElement("a"),t=document.createElement("img");e.href=n+"ffxiv_"+o[l].name+".png",t.src=n+"thumb/ffxiv_"+o[l].name+".png",console.log(t),e.appendChild(t),i.appendChild(e)}lg=window.lightGallery(document.getElementById("gallery"),{autoplayFirstVideo:!1,pager:!0,galleryId:"gallery",plugins:[lgZoom,lgPager],dynamic:!0,mobileSettings:{controls:!1,showCloseIcon:!1,download:!1,rotate:!1}}),initGallery()}function initGallery(){jQuery("#gallery").justifiedGallery({captions:!1,lastRow:"nojustify",rowHeight:260,margins:5}).on("jg.complete",function(){lg.openGallery()})}function test(){$("#gallery").justifiedGallery("destroy"),lg.refresh(),initGallery()}function removeTest(){const e=document.getElementById("gallery");elems=e.children,e.removeChild(elems[0]),test()}function doSearch(){for(initParams();gallery.firstChild;)gallery.removeChild(gallery.firstChild);var e=document.getElementById("fPlace"),t=document.getElementById("fAgent"),l=document.getElementById("fPatch");list=rawList,list=search(list,e.value,t.value,l.value),init()}function search(l,n,o,i){let s=[];o=o.substring(3,o.length),n=n.substring(3,n.length),i=parseInt(i.substring(3,i.length));for(let t=0;t<l.length;t++){let e=!0;"ALL"!=o&&o!=l[t].creator&&(e=!1),"ALL"!=n&&n!=l[t].place&&(e=!1),0!=i&&i!=parseInt(l[t].patch)&&(e=!1),e&&s.push(l[t])}return s}function attatch(n,e){for(let l=loaded;l<e;l++){let e=document.createElement("a"),t=document.createElement("img");e.href=directory+n[l].title+".png",t.src=directory+"thumb/"+n[l].title+".webp",void 0!==n[l].comment&&(t.alt=n[l].comment),loaded++,e.appendChild(t),gallery.appendChild(e)}return!1}async function getData(){rawList=await fetch("assets/data1692693035640.json").then(e=>e.json()),list=rawList}function initializeGalleries(){lg=lightGallery(gallery,{autoplayFirstVideo:!1,loop:!1,hideControlOnEnd:!0,download:!1,plugins:[lgZoom],mobileSettings:{controls:!1,showCloseIcon:!1,rotate:!1}}),initJg(),window.addEventListener("scroll",()=>{$window.scrollTop()>=$(document).height()-$window.height()-180&&!loading&&loadMore();const e=document.getElementById("scrollToTop");200<$window.scrollTop()?(e.classList.remove("scrlBtnHidden"),e.classList.add("scrlBtnShow")):(e.classList.remove("scrlBtnShow"),e.classList.add("scrlBtnHidden"))})}function loadMore(){loading=!0;let e;e=list.length-loaded>thumbsPerScroll?loaded+thumbsPerScroll:list.length,attatch(list,e),refresh(),setTimeout(()=>{loading=!1},1e3)}function initJg(){$("#gallery").justifiedGallery({captions:!1,lastRow:"nojustify",rowHeight:200,margins:8})}function blockSpoiler(){let t=gallery.children;var l=document.getElementById("fSpoiler").value;for(let e=0;e<t.length-1;e++)list[e].patch>l?t[e].classList.add("spoiler"):t[e].classList.remove("spoiler");return!0}function initParams(){loaded=0}